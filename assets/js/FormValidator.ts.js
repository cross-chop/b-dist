class a extends HTMLElement{form=null;submitButton=null;postMessageData=null;editMode=!1;allValid=!0;validatableElements=null;initialValues=new Map;connectedCallback(){const i=this.getAttribute("submit-button-id"),t=this.getAttribute("post-message");if(!i){console.error("FormValidator: submit-button-id attribute is required");return}if(this.getAttribute("edit-mode")==="true"&&(this.editMode=!0),this.postMessageData=t,this.form=this.querySelector("form"),this.submitButton=document.querySelector(`#${i}`),this.allValid=!0,this.validatableElements=this.form?.querySelectorAll("form-field, payment-options")||null,!this.form||!this.submitButton){console.error("FormValidator: form or submit button not found");return}this.submitButton.addEventListener("click",s=>{s.preventDefault(),this.handleSubmit()}),this.editMode&&(this.submitButton.closest(".Btn").classList.add("disabled"),setTimeout(()=>{this.handleEditMode()},1e3))}validateAll(){if(this.validatableElements)return this.allValid=!0,this.validatableElements.forEach(i=>{i.validate&&typeof i.validate=="function"&&(i.validate()||(this.allValid=!1))}),this.allValid}handleEditMode(){if(!this.form)return;const i=this.form.querySelectorAll("input, select, textarea");i.forEach(t=>{const e=t.type==="checkbox"||t.type==="radio"?t.checked.toString():t.value;this.initialValues.set(t,e)}),i.forEach(t=>{t.addEventListener("input",()=>this.handleValueChange()),t.addEventListener("change",()=>this.handleValueChange())})}handleValueChange(){let i=!1;if(this.initialValues.forEach((t,e)=>{(e.type==="checkbox"||e.type==="radio"?e.checked.toString():e.value)!==t&&(i=!0)}),i){if(this.validateAll()&&this.submitButton){const e=this.submitButton.closest(".Btn");e&&e.classList.remove("disabled")}else if(this.submitButton){const e=this.submitButton.closest(".Btn");e&&e.classList.add("disabled")}}else if(this.submitButton){const t=this.submitButton.closest(".Btn");t&&t.classList.add("disabled")}}handleSubmit(){if(this.form&&(this.validateAll(),this.allValid))if(this.postMessageData){const i=window.location.origin;try{const t=JSON.parse(this.postMessageData);window.postMessage(t,i)}catch{window.postMessage(this.postMessageData,i)}}else this.form.submit()}}customElements.define("form-validator",a);
